<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Signup Email - VolunTEEN</title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h3 class="text-center">Test Signup Email Process</h3>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <h5>Test Data:</h5>
                            <div class="form-group">
                                <label for="eventTitle">Event Title:</label>
                                <input type="text" id="eventTitle" class="form-control" value="Test Event" />
                            </div>
                            <div class="form-group">
                                <label for="supervisorEmail">Supervisor Email:</label>
                                <input type="email" id="supervisorEmail" class="form-control" value="test@example.com" />
                            </div>
                            <div class="form-group">
                                <label for="studentName">Student Name:</label>
                                <input type="text" id="studentName" class="form-control" value="Test Student" />
                            </div>
                            <div class="form-group">
                                <label for="hours">Hours:</label>
                                <input type="number" id="hours" class="form-control" value="2" />
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <button id="testSignupEmailBtn" class="btn btn-primary">Test Signup Email</button>
                            <button id="testMockEmailBtn" class="btn btn-warning">Test Mock Email Only</button>
                        </div>
                        
                        <div id="result" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import EmailService from './js/email-service.js';

        const emailService = new EmailService();
        
        // Test signup email process
        document.getElementById('testSignupEmailBtn').addEventListener('click', async () => {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="alert alert-info">Testing signup email process...</div>';
            
            try {
                const eventTitle = document.getElementById('eventTitle').value;
                const supervisorEmail = document.getElementById('supervisorEmail').value;
                const studentName = document.getElementById('studentName').value;
                const hours = document.getElementById('hours').value;
                
                // Simulate the event data structure from Firebase
                const eventData = {
                    title: eventTitle,
                    email: supervisorEmail,
                    eventDate: new Date().toISOString().slice(0,10),
                    id: 'test-event-' + Date.now(),
                    // Map to email service expected fields
                    firstName: eventTitle,
                    supervisorMail: supervisorEmail
                };
                
                const studentData = {
                    student_name: studentName,
                    student_email: studentName + '@example.com'
                };
                
                console.log('Testing with event data:', eventData);
                console.log('Testing with student data:', studentData);
                
                const result = await emailService.sendVolunteerApprovalEmail(eventData, studentData, hours);
                
                if (result.success) {
                    resultDiv.innerHTML = `
                        <div class="alert alert-success">
                            <h4>✅ Signup Email Test Successful!</h4>
                            <p>${result.message}</p>
                            <p><strong>Event:</strong> ${eventTitle}</p>
                            <p><strong>Supervisor:</strong> ${supervisorEmail}</p>
                            <p><strong>Student:</strong> ${studentName}</p>
                            <p><strong>Hours:</strong> ${hours}</p>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="alert alert-danger">
                            <h4>❌ Signup Email Test Failed</h4>
                            <p>${result.message}</p>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <h4>❌ Error Testing Signup Email</h4>
                        <p>${error.message}</p>
                        <pre>${error.stack}</pre>
                    </div>
                `;
            }
        });
        
        // Test mock email only
        document.getElementById('testMockEmailBtn').addEventListener('click', async () => {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="alert alert-info">Testing mock email...</div>';
            
            try {
                const eventTitle = document.getElementById('eventTitle').value;
                const supervisorEmail = document.getElementById('supervisorEmail').value;
                const studentName = document.getElementById('studentName').value;
                const hours = document.getElementById('hours').value;
                
                const eventData = {
                    title: eventTitle,
                    email: supervisorEmail,
                    eventDate: new Date().toISOString().slice(0,10),
                    id: 'test-event-' + Date.now(),
                    firstName: eventTitle,
                    supervisorMail: supervisorEmail
                };
                
                const studentData = {
                    student_name: studentName,
                    student_email: studentName + '@example.com'
                };
                
                const result = emailService.sendMockEmail(eventData, studentData, hours);
                
                if (result.success) {
                    resultDiv.innerHTML = `
                        <div class="alert alert-success">
                            <h4>✅ Mock Email Test Successful!</h4>
                            <p>${result.message}</p>
                            <p><strong>Event:</strong> ${eventTitle}</p>
                            <p><strong>Supervisor:</strong> ${supervisorEmail}</p>
                            <p><strong>Student:</strong> ${studentName}</p>
                            <p><strong>Hours:</strong> ${hours}</p>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="alert alert-danger">
                            <h4>❌ Mock Email Test Failed</h4>
                            <p>${result.message}</p>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <h4>❌ Error Testing Mock Email</h4>
                        <p>${error.message}</p>
                        <pre>${error.stack}</pre>
                    </div>
                `;
            }
        });
    </script>
</body>
</html> 